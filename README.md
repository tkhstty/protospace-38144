# README



# テーブル設計

## users テーブル
| Column             | Type        | Option             |
| ------------------ | ----------- | ------------------ |
| email              | string      | null:false, UNIQUE |
| encrypted_password | string      | null:false         |
| name               | string      | null:false         |
| profile            | text        | null:false         |
| occupation         | text        | null:false         |
| position           | text        | null:false         |

### Association
- has_many :prototypes
- has_many :comments


## prototypes テーブル
| Column             | Type        | Option                       |
| ------------------ | ----------- | ---------------------------- |
| title              | string      | null:false                   |
| catch_copy         | text        | null:false                   |
| concept            | text        | null:false                   |
| user               | reference   | null:false, foreign_key:true |

### Association
- has_many :comments
- belongs_to :user


## comments テーブル
| Column             | Type        | Option                       |
| ------------------ | ----------- | ---------------------------- |
| content            | text        | null:false                   |
| prototype          | reference   | null:false, foreign_key:true |
| user               | reference   | null:false, foreign_key:true |

### Association
- belongs_to user
- belongs_to prototype



# TEST

## 概要
- カリキュラムの確認項目に対応したテストを作成。
- README内の確認項目はカリキュラム記載順を維持。[対象カリキュラム](https://master.tech-camp.in/v2/curriculums/5287)
- 量が多いため、識別番号を付与。命名規則は以下。
 - 「abNum_」で命名。
 - a = カテゴリ(models = m, system = s)
 - b = 機能(user = u, prototype = p, comment = c)
 - Num = 通し番号
 - ex)「spec/models/user_spec.rb」の1つ目の確認項目 ⇛ mu1


## ユーザー管理機能
### spec/models/user_spec.rb
- mu1_ユーザーの新規登録には、メールアドレスが必須であること
- mu2_ユーザーの新規登録には、メールアドレスは一意性である
- mu3_ユーザーの新規登録には、メールアドレスは@を含む必要があること
- mu4_ユーザーの新規登録には、パスワードが必須であること
- mu5_ユーザーの新規登録には、パスワードは6文字以上であること
- mu6_ユーザーの新規登録には、パスワードは確認用を含めて2回入力すること
- mu7_ユーザーの新規登録には、パスワードとパスワード確認用の値の一致が必須であること
- mu8_ユーザーの新規登録には、ユーザー名が必須であること
- mu9_ユーザーの新規登録には、プロフィールが必須であること
- mu10_ユーザーの新規登録には、所属が必須であること
- mu11_ユーザーの新規登録には、役職が必須であること

### spec/system/users_spec.rb
- su1_必須項目に適切な値を入力すると、ユーザーの新規登録ができること
- su2_必要な情報を入力すると、ログインができること
- su3-1,2_フォームに適切な値が入力されていない状態では、新規登録・ログインはできず、そのページに留まること（新規登録/ログイン）
- su4_トップページから、ログアウトができること
- su5_ログアウト状態では、ヘッダーに「新規登録」「ログイン」のリンクが存在すること
- su6_ログイン状態では、ヘッダーに「ログアウト」「New Proto」のリンクが存在すること
- su7_ログイン状態では、トップページに「こんにちは、〇〇さん」とユーザー名が表示されていること


## プロトタイプ投稿機能
### spec/models/prototype_spec.rb
- mp1_プロトタイプの名称が必須であること
- mp2_キャッチコピーが必須であること
- mp3_コンセプトの情報が必須であること
- mp4_画像は1枚必須であること(ActiveStorageを使用)

### spec/system/prototypes_spec.rb
- sp1_ログイン状態のユーザーだけが、投稿ページへ遷移できること
- sp2_投稿に必要な情報が入力されていない場合は、投稿できずにそのページに留まること
- sp3_バリデーションによって投稿ができず、そのページに留まった場合でも、入力済みの項目（画像以外）は消えないこと
- sp4_必要な情報を入力すると、投稿ができること
- sp5_正しく投稿できた場合は、トップページへ遷移すること
- sp6_投稿した情報は、トップページに表示されること
- sp7_トップページに表示される投稿情報は、プロトタイプ毎に、画像・プロトタイプ名・キャッチコピー・投稿者の名前の、4つの情報について表示できること
- sp8_画像が表示されており、画像がリンク切れなどになっていないこと（Herokuの仕様による画像のリンク切れは、要件未達に含まれない。Heroku上では一定時間経過すると画像が消える。）


## プロトタイプ詳細ページ機能
### spec/system/prototypes_spec.rb
- sp9-1,2,3,4_ログイン・ログアウトの状態に関わらず、一覧表示されている画像およびプロトタイプ名をクリックすると、該当するプロトタイプの詳細ページへ遷移すること
- sp10-1,2_ログイン状態の投稿したユーザーだけに、「編集」「削除」のリンクが存在すること
- sp11-1,2_ログイン・ログアウトの状態に関わらず、プロダクトの情報（プロトタイプ名・投稿者・画像・キャッチコピー・コンセプト）が表示されていること
- sp12-1,2_画像が表示されており、画像がリンク切れなどになっていないこと（Herokuの仕様による画像のリンク切れは、要件未達に含まれない。Heroku上では一定時間経過すると画像が消える。）


## プロトタイプ編集機能
### spec/system/prototypes_spec.rb
- sp13_投稿に必要な情報を入力すると、プロトタイプが編集できること
- sp14_何も編集せずに更新をしても、画像無しのプロトタイプにならないこと
- sp15-1,2_ログイン状態のユーザーに限り、自身の投稿したプロトタイプの詳細ページから編集ボタンをクリックすると、編集ページへ遷移できること
- sp16_プロトタイプ情報について、すでに登録されている情報は、編集画面を開いた時点で表示されること（画像は表示されない状態で良い）
- sp17_空の入力欄がある場合は、編集できずにそのページに留まること
- sp18_バリデーションによって編集ができず、そのページに留まった場合でも、入力済みの項目（画像以外）は消えないこと
- sp19_正しく編集できた場合は、詳細ページへ遷移すること


## プロトタイプ削除機能
### spec/system/prototypes_spec.rb
- sp20-1,2_ログイン状態のユーザーに限り、自身の投稿したプロトタイプの詳細ページから削除ボタンをクリックすると、プロトタイプを削除できること
- sp21_削除が完了すると、トップページへ遷移すること


## コメント投稿機能
### spec/system/comments_spec.rb
- sc1_コメント投稿欄は、ログイン状態のユーザーへのみ、詳細ページに表示されていること
- sc2_正しくフォームを入力すると、コメントが投稿できること
- sc3_コメントを投稿すると、詳細ページに戻ってくること
- sc4_コメントを投稿すると、投稿したコメントとその投稿者名が、対象プロトタイプの詳細ページにのみ表示されること
- sc5_フォームを空のまま投稿しようとすると、投稿できずにそのページに留まること


## ユーザー詳細ページ機能
### spec/system/users_spec.rb
- su8-1,2_ログイン・ログアウトの状態に関わらず、各ページのユーザー名をクリックすると、ユーザーの詳細ページへ遷移すること
- su9-1,2_ログイン・ログアウトの状態に関わらず、ユーザーの詳細ページには、そのユーザーの詳細情報（名前・プロフィール・所属・役職）と、そのユーザーが投稿したプロトタイプが表示されていること


## その他
### spec/requests/prototypes_spec.rb
- sp22_ログアウト状態のユーザーは、プロトタイプ新規投稿ページ・プロトタイプ編集ページに遷移しようとすると、ログインページにリダイレクトされること（ページはないが、削除機能にも同様の実装を行うこと）
- sp23_ログアウト状態のユーザーであっても、トップページ・プロトタイプ詳細ページ・ユーザー詳細ページ・ユーザー新規登録ページ・ログインページには遷移できること
- su24_ログイン状態のユーザーであっても、他のユーザーのプロトタイプ編集ページのURLを直接入力して遷移しようとすると、トップページにリダイレクトされること